---
title: "Vertex AI Workbenchä¸Šã§RStudio Serverã‚’å‹•ã‹ã™"
emoji: "ğŸ¦†"
type: "tech" # tech: æŠ€è¡“è¨˜äº‹ / idea: ã‚¢ã‚¤ãƒ‡ã‚¢
topics:
  - "r"
  - "rstudio"
  - "vertexai"
published: true
---

# ã¯ã˜ã‚ã«

Vertex AI Workbenchã§RStudio Serverã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¦å‹•ã‹ã—ãŸã®ã§ãã®ãƒ¡ãƒ¢ã§ã™ã€‚


![](/images/b564bbf9863d74/rstudio.png)

# æ‰‹é †
## Vertex AI Workbenchã§æ–°è¦ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã®ä½œæˆ

- Vertex AI Workbenchã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ« https://console.cloud.google.com/vertex-ai/workbench/instances ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚

- `NEW NOTEBOOK`ã‚’æŠ¼ä¸‹ã—ã¦ã€æ–°ã—ã„ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã‚’ä½œæˆã—ã¾ã™ã€‚ã“ã®ã¨ãã€`R 4.2`ã‚’é¸æŠã—ã¾ã™ã€‚
  - ![](/images/b564bbf9863d74/newnotebook.png)


- ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒèµ·å‹•ã—ã€`OPEN JUPYTERLAB`ãŒæŠ¼ä¸‹ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã‚‰æŠ¼ä¸‹ã—ã¦Jupyterlabã‚’èµ·å‹•ã—ã¾ã™ã€‚

## RStudio Serverã®ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«

- Jupyterlabå†…ã§`Terminal`ã‚’èµ·å‹•ã—ã¾ã™ã€‚
  - ![](/images/b564bbf9863d74/launcher.png)

- https://posit.co/download/rstudio-server/ ã‚’å‚ç…§ã—ã¦ã€RStudio Serverã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã—ã¾ã™ã€‚`Select Your Operating System:`ã¯ã€`Debian / Ubuntu`ã§ã™ã€‚ä»Šå›ã¯ä»¥ä¸‹ã®3ã¤ã®ã‚³ãƒãƒ³ãƒ‰ã§ã—ãŸã€‚

```
sudo apt-get install gdebi-core
```

```
wget https://download2.rstudio.org/server/bionic/amd64/rstudio-server-2022.12.0-353-amd64.deb
```

```
sudo gdebi rstudio-server-2022.12.0-353-amd64.deb
```

## ãƒ¦ãƒ¼ã‚¶ãƒ¼è¿½åŠ 
- RStudioã«ãƒ­ã‚°ã‚¤ãƒ³ã™ã‚‹ãŸã‚ã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’è¨­å®šã—ã¾ã™ã€‚

- RStudioã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¯ã€ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ä¸Šã®ãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã§ã‚ã‚‹ãŸã‚ã€ãã®ã¾ã¾Jupyterlabå†…ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¾ã™ã€‚

```
$ sudo adduser kn1kn1
Adding user `kn1kn1' ...
Adding new group `kn1kn1' (1011) ...
Adding new user `kn1kn1' (1010) with group `kn1kn1' ...
Creating home directory `/home/kn1kn1' ...
Copying files from `/etc/skel' ...
New password: 
Retype new password: 
passwd: password updated successfully
Changing the user information for kn1kn1
Enter the new value, or press ENTER for the default
        Full Name []: 
        Room Number []: 
        Work Phone []: 
        Home Phone []: 
        Other []: 
Is the information correct? [Y/n] Y
$ 
```

## SSHãƒãƒ¼ãƒˆè»¢é€ã‚’ä½¿ç”¨ã—ã¦ã€RStudioã«æ¥ç¶š

RStudioã«ãƒ–ãƒ©ã‚¦ã‚¶ã§ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚ãƒ•ã‚¡ã‚¤ã‚¢ã‚¦ã‚©ãƒ¼ãƒ«ã®è¨­å®šç­‰ãŒç…©é›‘ãªãŸã‚ã€SSHãƒãƒ¼ãƒˆè»¢é€ã‚’ä½¿ç”¨ã—ã¾ã™ã€‚

https://cloud.google.com/architecture/running-rstudio-server-on-a-cloud-dataproc-cluster?hl=ja#connect_through_ssh_port_forwarding ã®æ‰‹é †ã‚’å‚è€ƒã«ã—ã¾ã—ãŸã€‚


- ãƒ­ãƒ¼ã‚«ãƒ«ãƒã‚·ãƒ³ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§ã€ä»¥ä¸‹ã®ã‚³ãƒãƒ³ãƒ‰ã‚’å®Ÿè¡Œã—ã¦ã€ãƒãƒ¼ãƒˆè»¢é€ã—ã¾ã™ã€‚`INSTANCE_NAME`ã¯ã€Compute Engineã®ã‚³ãƒ³ã‚½ãƒ¼ãƒ«  https://console.cloud.google.com/compute/instances ã‹ã‚‰èª¿ã¹ã¦ã„ãã¨è‰¯ã„ã§ã—ã‚‡ã†ã€‚
```
gcloud compute ssh \
    --zone=ZONE \
    --project=PROJECT_ID \
    INSTANCE_NAME -- \
    -L 8787:localhost:8787
```

- http://localhost:8787/ ã«ã‚¢ã‚¯ã‚»ã‚¹ã—ã¾ã™ã€‚ãƒ­ã‚°ã‚¤ãƒ³ç”»é¢ãŒè¡¨ç¤ºã•ã‚ŒãŸã‚‰ã€å…ˆç¨‹ä½œæˆã—ãŸãƒ¦ãƒ¼ã‚¶ãƒ¼ã¨ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã‚’å…¥åŠ›ã—ã¦ãƒ­ã‚°ã‚¤ãƒ³ã—ã¾ã™ã€‚
  - ![](/images/b564bbf9863d74/login.png)



# ãŠã‚ã‚Šã«

ä»¥å‰ã¯Compute Engineã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ã«Rã‚’ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã™ã‚‹ã¨ã“ã‚ã‹ã‚‰ã‚„ã£ã¦ã„ãŸã®ã§ã™ãŒã€Vertex AI Workbenchã§RãŒã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«ã•ã‚ŒãŸçŠ¶æ…‹ã®ã‚¤ãƒ³ã‚¹ã‚¿ãƒ³ã‚¹ãŒæä¾›ã•ã‚Œã€ã‹ãªã‚Šæ‰‹é †ã‚’è»½æ¸›ã§ãã‚‹ã‚ˆã†ã«ãªã£ãŸã¨æ„Ÿã˜ã¾ã—ãŸã€‚

